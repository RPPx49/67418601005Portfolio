<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portfolio - 67418601005</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&amp;family=Poppins:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <style>
    body { box-sizing: border-box; }
    * { font-family: 'Noto Sans Thai', 'Poppins', sans-serif; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #1e293b; }
    ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 3px; }
    
    /* Animations */
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideIn { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
    
    .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
    .animate-slide-in { animation: slideIn 0.5s ease-out forwards; }
    .animate-scale-in { animation: scaleIn 0.2s ease-out forwards; }
    
    /* --- Slider Styles (‡∏•‡πá‡∏≠‡∏Ñ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô 16:9) --- */
    .slider-container {
      position: relative;
      overflow: hidden;
      border-radius: 1rem;
      width: 100%;
      aspect-ratio: 16 / 9; /* ‡∏•‡πá‡∏≠‡∏Ñ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô 16:9 */
      background-color: #0f172a;
    }
    
    .slider-track {
      display: flex;
      height: 100%;
      width: 100%;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .slider-item {
      min-width: 100%;
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      position: relative;
    }
    
    .slider-item img {
      width: 100%;
      height: 100%;
      object-fit: cover; 
      object-position: center;
      display: block;
    }

    .slider-dot { 
      transition: all 0.3s ease; 
      cursor: pointer;
    }
    .slider-dot.active { 
      background: linear-gradient(135deg, #3b82f6, #8b5cf6); 
      width: 32px; 
    }

    /* Cards & UI */
    .portfolio-card { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    .portfolio-card:hover { transform: translateY(-10px) scale(1.02); box-shadow: 0 25px 50px -12px rgba(59, 130, 246, 0.35); }
    .portfolio-card:hover .card-image { transform: scale(1.1); }
    .portfolio-card:hover .card-overlay { opacity: 1; }
    .card-image { transition: transform 0.5s ease; }
    .card-overlay { opacity: 0; transition: opacity 0.3s ease; }
    
    .menu-btn { transition: all 0.3s ease; position: relative; overflow: hidden; }
    .menu-btn::before { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px; background: linear-gradient(180deg, #3b82f6, #8b5cf6); transform: scaleY(0); transition: transform 0.3s ease; }
    .menu-btn:hover::before, .menu-btn.active::before { transform: scaleY(1); }
    .menu-btn:hover, .menu-btn.active { background: linear-gradient(90deg, rgba(59, 130, 246, 0.2), transparent); padding-left: 1.5rem; }
    
    .profile-ring { background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ec4899); padding: 4px; border-radius: 50%; animation: pulse 3s ease-in-out infinite; }
    .glass { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
    .modal-backdrop { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px); }
    .gradient-text { background: linear-gradient(135deg, #3b82f6, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    
    .mobile-menu { transition: transform 0.3s ease, opacity 0.3s ease; }
    .mobile-menu.hidden { transform: translateX(-100%); opacity: 0; pointer-events: none; }
    .mobile-menu.visible { transform: translateX(0); opacity: 1; pointer-events: auto; }
    
    /* Admin Visibility Logic */
    .admin-controls { display: none !important; }
    body.is-admin .admin-controls { display: flex !important; }
    body.is-admin .admin-login-btn { display: none !important; }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-slate-900 text-white overflow-auto">
  <div id="app" class="h-full w-full flex flex-col lg:flex-row">
   
   <header class="lg:hidden fixed top-0 left-0 right-0 z-40 glass px-4 py-3 flex items-center justify-between">
    <div class="flex items-center gap-3">
     <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-lg font-bold overflow-hidden" id="mobile-avatar">
        <img src="https://media.discordapp.net/attachments/1441707634980950108/1465674087627100160/9.png?ex=6979f6dd&is=6978a55d&hm=225a68479206898c03f363a4b29f9a8b43abaa3a1ffc17147752c7578470abbc&=&format=webp&quality=lossless&width=475&height=619" class="w-full h-full object-cover">
     </div>
     <span class="font-semibold text-sm" id="mobile-name">‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏±‡∏í‡∏ô‡πå</span>
    </div>
    <div class="flex gap-2">
        <button id="mobile-menu-btn" class="p-2 rounded-lg hover:bg-slate-700 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
        </button>
    </div>
   </header>

   <div id="mobile-menu-overlay" class="lg:hidden fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/60" id="overlay-backdrop"></div>
    <aside class="mobile-menu hidden absolute left-0 top-0 bottom-0 w-80 max-w-[85vw] bg-slate-800 flex flex-col h-full">
     <div class="p-6 flex-1 overflow-y-auto">
      <button id="close-menu-btn" class="absolute top-4 right-4 p-2 rounded-lg hover:bg-slate-700 transition-colors">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </button> 
      <div class="text-center mb-8 pt-4">
       <div class="profile-ring w-28 h-28 mx-auto mb-4"> 
        <div class="w-full h-full rounded-full bg-slate-700 flex items-center justify-center overflow-hidden">
         <img src="https://media.discordapp.net/attachments/1441707634980950108/1465674087627100160/9.png?ex=6979f6dd&is=6978a55d&hm=225a68479206898c03f363a4b29f9a8b43abaa3a1ffc17147752c7578470abbc&=&format=webp&quality=lossless&width=475&height=619" alt="‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏±‡∏í‡∏ô‡πå" class="w-full h-full object-cover">
        </div>
       </div>
       <h2 class="text-xl font-bold gradient-text mb-1" id="sidebar-name-mobile">‡∏ô‡∏≤‡∏¢‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏±‡∏í‡∏ô‡πå ‡πÅ‡∏î‡∏ô‡∏î‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á</h2>
       <p class="text-slate-400 text-sm mb-1" id="sidebar-major-mobile">‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
       <p class="text-blue-400 text-sm font-mono" id="sidebar-id-mobile">67414401017</p>
      </div>
      <nav class="mb-8" id="mobile-nav"></nav>
      <div class="border-t border-slate-700 pt-6">
       <h3 class="text-xs uppercase tracking-wider text-slate-500 mb-4 font-semibold">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h3>
       <div class="space-y-3">
        <a href="#" class="flex items-center gap-3 text-slate-300 hover:text-blue-400 transition-colors text-sm" id="contact-email-mobile">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg><span>example@email.com</span> 
        </a> 
        <a href="#" class="flex items-center gap-3 text-slate-300 hover:text-blue-400 transition-colors text-sm" id="contact-phone-mobile">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg><span>0xx-xxx-xxxx</span> 
        </a>
       </div>
      </div>
     </div>
     
     <div class="p-4 border-t border-slate-700 bg-slate-800/50 mt-auto">
        <button onclick="toggleLoginModal()" class="admin-login-btn w-full py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm text-slate-300 transition-colors">Admin Login</button>
        <button onclick="adminLogout()" class="admin-controls w-full py-2 bg-red-500/20 text-red-400 rounded-lg text-sm hover:bg-red-500/30 transition-colors justify-center">
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
        </button>
     </div>
    </aside>
   </div>

   <aside class="hidden lg:flex lg:flex-col lg:w-64 xl:w-72 bg-slate-800 border-r border-slate-700 h-full overflow-hidden flex-shrink-0">
    <div class="p-6 xl:p-8 flex flex-col h-full overflow-y-auto">
     <div class="text-center mb-8 animate-slide-in">
       <div class="profile-ring w-32 h-32 xl:w-36 xl:h-36 mx-auto mb-4">
       <div class="w-full h-full rounded-full bg-slate-700 flex items-center justify-center overflow-hidden">
        <img src="https://media.discordapp.net/attachments/1441707634980950108/1465674087627100160/9.png?ex=6979f6dd&is=6978a55d&hm=225a68479206898c03f363a4b29f9a8b43abaa3a1ffc17147752c7578470abbc&=&format=webp&quality=lossless&width=475&height=619" alt="‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏±‡∏í‡∏ô‡πå" class="w-full h-full object-cover">
       </div>
      </div>
      <h1 class="text-base xl:text-lg font-bold gradient-text mb-1" id="sidebar-name">‡∏ô‡∏≤‡∏¢‡∏£‡∏∞‡∏û‡∏µ‡∏û‡∏±‡∏í‡∏ô‡πå ‡πÅ‡∏î‡∏ô‡∏î‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á</h1>
      <p class="text-slate-400 text-sm xl:text-base mb-1" id="sidebar-major">‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
      <p class="text-blue-400 font-mono text-sm" id="sidebar-id">67414401017</p>
     </div>
     
     <nav class="flex-1 mb-6" id="desktop-nav">
      <h3 class="text-xs uppercase tracking-wider text-slate-500 mb-3 font-semibold">‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</h3>
      <div class="space-y-1" id="menu-container"></div>
     </nav>
     
     <div class="border-t border-slate-700 pt-6 pb-6">
      <h3 class="text-xs uppercase tracking-wider text-slate-500 mb-4 font-semibold">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h3>
      <div class="space-y-3">
        <a href="#" class="flex items-center gap-3 text-slate-300 hover:text-blue-400 transition-colors group" id="contact-email">
            <div class="w-10 h-10 rounded-lg bg-slate-700 flex items-center justify-center group-hover:bg-blue-500/20 transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg></div><span class="text-sm">example@email.com</span>
        </a>
        <a href="#" class="flex items-center gap-3 text-slate-300 hover:text-blue-400 transition-colors group" id="contact-phone">
            <div class="w-10 h-10 rounded-lg bg-slate-700 flex items-center justify-center group-hover:bg-blue-500/20 transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg></div><span class="text-sm">0xx-xxx-xxxx</span>
        </a>
      </div>
     </div>
    </div>
    
    <div class="p-4 bg-slate-900/50 border-t border-slate-700 mt-auto">
        <button onclick="toggleLoginModal()" class="admin-login-btn w-full flex items-center justify-center gap-2 py-2 text-xs text-slate-500 hover:text-slate-300 transition-colors rounded-lg hover:bg-slate-800">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
            Admin Login
        </button>
        <button onclick="adminLogout()" class="admin-controls w-full flex items-center justify-center gap-2 py-2 text-sm text-red-400 hover:text-red-300 transition-colors rounded-lg hover:bg-red-500/10">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
        </button>
    </div>
   </aside>

   <main class="flex-1 overflow-y-auto pt-16 lg:pt-0">
    <div class="p-4 lg:p-8 xl:p-10">
     
     <section class="mb-12 animate-fade-in">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
       <div class="lg:col-span-2">
        <div class="slider-container glass min-h-96 relative group">
         <div class="slider-track w-full h-full" id="slider-track"></div>
         <button class="absolute left-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-full bg-black/50 hover:bg-black/70 text-white opacity-0 group-hover:opacity-100 transition-opacity" id="slider-prev"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
         <button class="absolute right-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-full bg-black/50 hover:bg-black/70 text-white opacity-0 group-hover:opacity-100 transition-opacity" id="slider-next"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></button>
         <div class="absolute bottom-4 left-1/2 -translate-x-1/2 z-20 flex gap-2" id="slider-dots"></div>
        </div>
       </div>
       <div class="lg:col-span-1">
        <div class="glass rounded-2xl p-6 h-full flex flex-col sticky top-16 lg:top-0">
         <h3 class="text-sm uppercase tracking-wider text-slate-500 mb-4 font-semibold">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
         <div class="flex-1 flex flex-col justify-between">
          <div>
            <span class="px-3 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400 inline-block mb-3" id="featured-category">...</span>
           <h2 class="text-2xl font-bold mb-4 text-white" id="featured-title">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</h2>
           <div class="mb-6">
            <h4 class="text-sm text-slate-400 mb-2 font-medium">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h4>
            <p class="text-slate-300 text-sm leading-relaxed line-clamp-4" id="featured-description">...</p>
           </div>
          </div>
          <div class="flex flex-wrap gap-2" id="featured-actions"></div>
         </div>
        </div>
       </div>
      </div>
     </section>

     <header class="mb-8 animate-fade-in flex flex-wrap justify-between items-end gap-4" style="animation-delay: 0.2s">
      <div>
          <h2 class="text-3xl xl:text-4xl font-bold mb-2"><span class="gradient-text">Portfolio</span> ‡∏ú‡∏•‡∏á‡∏≤‡∏ô</h2>
      </div>
      <button onclick="openEditModal()" class="admin-controls px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg items-center gap-2 transition-colors shadow-lg shadow-green-900/20">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</span>
      </button>
     </header>

     <div class="mb-6 flex items-center gap-2 text-sm" id="filter-info">
        <span class="text-slate-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á:</span> 
        <span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-400 font-medium" id="current-filter">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span> 
        <span class="text-slate-500">(<span id="item-count">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</span>
     </div>

     <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6" id="portfolio-grid">
         <div class="col-span-full py-12 text-center text-slate-500">
             <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-2"></div>
             <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
         </div>
     </div>

     <div class="hidden text-center py-16" id="empty-state">
      <svg class="w-24 h-24 mx-auto text-slate-600 mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
      <h3 class="text-xl font-semibold text-slate-400 mb-2">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏á‡∏≤‡∏ô</h3>
      <p class="text-slate-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ</p>
     </div>
    </div>
   </main>

   <div class="fixed inset-0 z-[60] hidden" id="login-modal">
       <div class="modal-backdrop absolute inset-0" onclick="toggleLoginModal()"></div>
       <div class="absolute inset-0 flex items-center justify-center p-4">
           <div class="glass rounded-2xl w-full max-w-sm p-8 animate-scale-in">
               <h3 class="text-2xl font-bold mb-6 text-center text-white">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</h3>
               <div class="space-y-4">
                   <div>
                       <label class="block text-sm text-slate-400 mb-1">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                       <input type="password" id="admin-password" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500 transition-colors" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô...">
                   </div>
                   <button onclick="adminLogin()" class="w-full py-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg text-white font-medium hover:opacity-90 transition-opacity">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                   <p id="login-error" class="text-red-400 text-sm text-center hidden">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
               </div>
           </div>
       </div>
   </div>

   <div class="fixed inset-0 z-[60] hidden" id="edit-modal">
       <div class="modal-backdrop absolute inset-0" onclick="closeEditModal()"></div>
       <div class="absolute inset-2 sm:inset-4 lg:inset-8 flex items-center justify-center">
           <div class="glass rounded-2xl w-full max-w-xl max-h-[90vh] overflow-hidden flex flex-col animate-scale-in bg-slate-900">
               <div class="flex items-center justify-between p-4 border-b border-slate-700 bg-slate-800">
                   <h3 class="text-lg font-bold text-white" id="edit-modal-title">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ú‡∏•‡∏á‡∏≤‡∏ô</h3>
                   <button onclick="closeEditModal()" class="text-slate-400 hover:text-white"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
               </div>
               <div class="p-6 overflow-y-auto space-y-4">
                   <input type="hidden" id="edit-id">
                   <div>
                       <label class="block text-sm text-slate-400 mb-1">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ú‡∏•‡∏á‡∏≤‡∏ô</label>
                       <input type="text" id="edit-title" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500">
                   </div>
                   <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm text-slate-400 mb-1">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                            <select id="edit-category" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500">
                                <option value="TEA2201">TEA2201</option>
                                <option value="TEA3202">TEA3202</option>
                            </select>
                        </div>
                   </div>
                   
                   <div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700/50">
                       <label class="block text-sm text-blue-400 mb-2 font-semibold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (Image URL)</label>
                       <div class="flex gap-4 items-start">
                           <div class="flex-1">
                                <input type="text" id="edit-image" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white text-sm focus:outline-none focus:border-blue-500" placeholder="https://example.com/image.jpg" oninput="updateImagePreview(this.value)">
                                <p class="text-xs text-slate-500 mt-1">*‡πÉ‡∏™‡πà Link ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏ù‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏´‡∏£‡∏∑‡∏≠ Google Drive</p>
                           </div>
                           <div class="w-24 h-24 bg-slate-700 rounded-lg overflow-hidden flex-shrink-0 border border-slate-600">
                               <img id="edit-image-preview" src="" class="w-full h-full object-cover hidden" onerror="this.classList.add('hidden')">
                               <div id="edit-image-placeholder" class="w-full h-full flex items-center justify-center text-slate-500 text-xs text-center p-1">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á<br>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</div>
                           </div>
                       </div>
                   </div>

                   <div>
                       <label class="block text-sm text-slate-400 mb-1">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                       <textarea id="edit-description" rows="4" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500"></textarea>
                   </div>
                   <div>
                       <label class="block text-sm text-slate-400 mb-1">‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏ú‡∏•‡∏á‡∏≤‡∏ô (URL)</label>
                       <input type="text" id="edit-link" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500" placeholder="https://...">
                   </div>
               </div>
               <div class="p-4 border-t border-slate-700 bg-slate-800 flex justify-end gap-2">
                   <button onclick="closeEditModal()" class="px-4 py-2 rounded-lg hover:bg-slate-700 text-slate-300">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                   <button onclick="savePortfolioItem()" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg font-medium" id="save-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
               </div>
           </div>
       </div>
   </div>

   <div class="fixed inset-0 z-50 hidden" id="lightbox-modal">
    <div class="modal-backdrop absolute inset-0" id="modal-backdrop"></div>
    <div class="absolute inset-2 sm:inset-4 lg:inset-8 flex items-center justify-center">
     <div class="glass rounded-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden animate-scale-in flex flex-col">
      <div class="flex items-center justify-between p-4 border-b border-slate-700 flex-shrink-0">
       <div><span class="px-2 py-1 rounded text-xs font-medium bg-blue-500/20 text-blue-400" id="modal-category">TEA2201</span></div>
       <button class="p-2 rounded-lg hover:bg-slate-700 transition-colors" id="close-modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
      </div>
      <div class="overflow-y-auto flex-1">
       <div class="h-96 bg-slate-700 relative overflow-hidden">
        <img id="modal-image" src="" alt="" class="w-full h-full object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
        <div class="absolute inset-0 hidden items-center justify-center bg-slate-700">
         <svg class="w-16 h-16 text-slate-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
        </div>
       </div>
       <div class="p-6">
        <h3 class="text-2xl font-bold mb-3" id="modal-title">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ú‡∏•‡∏á‡∏≤‡∏ô</h3>
        <p class="text-slate-300 leading-relaxed mb-6" id="modal-description">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ú‡∏•‡∏á‡∏≤‡∏ô</p>
        <div class="flex flex-wrap gap-3" id="modal-actions">
         <a href="#" target="_blank" rel="noopener noreferrer" class="hidden px-6 py-3 rounded-xl bg-gradient-to-r from-blue-500 to-purple-500 text-white font-medium hover:opacity-90 transition-opacity inline-flex items-center gap-2" id="modal-link">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg><span>‡∏î‡∏π‡∏ú‡∏•‡∏á‡∏≤‡∏ô</span> 
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>

  </div>

  <script>
    // =============================================================
    // 1. Firebase Configuration & Init
    // =============================================================
    const firebaseConfig = { 
        apiKey: "AIzaSyD2woYelmBQUAOLteN0jyEeuwAmBi1yUsE",
        authDomain: "tea2201aichan.firebaseapp.com",
        projectId: "tea2201aichan",
        storageBucket: "tea2201aichan.firebasestorage.app",
        messagingSenderId: "177550454287",
        appId: "1:177550454287:web:074ee21a32343e51483d7a",
        measurementId: "G-QD58L1FM7W"
    };

    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.firestore();
    const COLLECTION_NAME = 'portfolio_items';

    // =============================================================
    // 2. Data & State Management
    // =============================================================
    
    let portfolioData = [];
    let isAdmin = false; 
    
    const categories = [
      { id: "all", name: "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", icon: "üìö" },
      { id: "TEA2201", name: "TEA2201", icon: "üí°" },
      { id: "TEA3202", name: "TEA3202", icon: "üñ•Ô∏è" }
    ];

    const defaultConfig = {
      owner_name: "‡∏õ‡∏¥‡∏¢‡∏∞‡∏û‡∏±‡∏ä‡∏£‡πå ‡∏õ‡∏±‡∏ì‡∏ì‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏ô‡∏ô‡∏ó‡πå",
      owner_major: "‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏ê‡∏°‡∏ß‡∏±‡∏¢",
      owner_id: "67418601005",
      contact_email: "ice.piyapat48@gmail.com",
      contact_phone: "097-117-4458"
    };

    // =============================================================
    // 3. Admin & Auth Logic
    // =============================================================

    function toggleLoginModal() {
        const modal = document.getElementById('login-modal');
        const input = document.getElementById('admin-password');
        const error = document.getElementById('login-error');
        
        if (modal.classList.contains('hidden')) {
            modal.classList.remove('hidden');
            input.value = '';
            error.classList.add('hidden');
            input.focus();
        } else {
            modal.classList.add('hidden');
        }
    }

    function adminLogin() {
        const pass = document.getElementById('admin-password').value;
        if (pass === 'RPPx') {
            isAdmin = true;
            document.body.classList.add('is-admin');
            toggleLoginModal();
            generatePortfolioCards(); 
            alert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
        } else {
            document.getElementById('login-error').classList.remove('hidden');
        }
    }

    function adminLogout() {
        isAdmin = false;
        document.body.classList.remove('is-admin');
        generatePortfolioCards();
        alert('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
    }

    // =============================================================
    // 4. CRUD Operations
    // =============================================================

    // Move Item Logic (Up/Down)
    async function moveItem(id, direction, event) {
        event.stopPropagation();
        const btn = event.currentTarget;
        btn.disabled = true; // prevent double click
        
        // Use current visible list
        const list = currentFilter === 'all' ? portfolioData : portfolioData.filter(i => i.category === currentFilter);
        const index = list.findIndex(i => i.id === id);
        
        if (index === -1 || index + direction < 0 || index + direction >= list.length) {
            btn.disabled = false;
            return;
        }
        
        const itemA = list[index];
        const itemB = list[index + direction];
        
        let orderA = typeof itemA.order === 'number' ? itemA.order : 0;
        let orderB = typeof itemB.order === 'number' ? itemB.order : 0;
        
        // Normalization Check: If orders are invalid or same, fix entire list first
        if (orderA === orderB || orderA === 0 || orderB === 0) {
            const batch = db.batch();
            portfolioData.forEach((item, idx) => {
                const ref = db.collection(COLLECTION_NAME).doc(item.id);
                batch.update(ref, { order: idx });
                item.order = idx; // Update local too
            });
            await batch.commit();
            
            // Re-assign correct orders after normalization
            orderA = itemA.order;
            orderB = itemB.order;
        }
        
        // Swap Orders
        const batch = db.batch();
        const refA = db.collection(COLLECTION_NAME).doc(itemA.id);
        const refB = db.collection(COLLECTION_NAME).doc(itemB.id);
        
        batch.update(refA, { order: orderB });
        batch.update(refB, { order: orderA });
        
        try {
            await batch.commit();
            fetchPortfolio(); // Reload to see changes
        } catch(e) {
            console.error(e);
            alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô: ' + e.message);
            btn.disabled = false;
        }
    }

    // READ
    async function fetchPortfolio() {
        const grid = document.getElementById('portfolio-grid');
        grid.innerHTML = `<div class="col-span-full py-12 text-center text-slate-500"><div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-2"></div><p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p></div>`;
        
        try {
            const snapshot = await db.collection(COLLECTION_NAME).get();
            portfolioData = snapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));
            
            // Sort by Order, then by Date (Newest first as fallback)
            portfolioData.sort((a, b) => {
                const orderA = typeof a.order === 'number' ? a.order : 999999999;
                const orderB = typeof b.order === 'number' ? b.order : 999999999;
                return orderA - orderB || (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0);
            });
            
            initSlider();
            generatePortfolioCards();
            generateMenu('menu-container');
            generateMenu('mobile-nav', true);
            
        } catch (error) {
            console.error("Error fetching data:", error);
            grid.innerHTML = `<div class="col-span-full text-center text-red-400">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>`;
        }
    }

    // CREATE / UPDATE
    function openEditModal(id = null) {
        const modal = document.getElementById('edit-modal');
        const titleEl = document.getElementById('edit-modal-title');
        
        // Reset form
        document.getElementById('edit-id').value = '';
        document.getElementById('edit-title').value = '';
        document.getElementById('edit-category').value = 'TEA2201';
        document.getElementById('edit-description').value = '';
        document.getElementById('edit-image').value = '';
        document.getElementById('edit-link').value = '';
        updateImagePreview(''); // Reset preview

        if (id) {
            const item = portfolioData.find(p => p.id === id);
            if (item) {
                document.getElementById('edit-id').value = item.id;
                document.getElementById('edit-title').value = item.title;
                document.getElementById('edit-category').value = item.category;
                document.getElementById('edit-description').value = item.description;
                document.getElementById('edit-image').value = item.imageSrc || '';
                document.getElementById('edit-link').value = item.linkUrl || '';
                updateImagePreview(item.imageSrc || '');
                titleEl.textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            }
        } else {
            titleEl.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà';
        }
        
        modal.classList.remove('hidden');
    }

    function updateImagePreview(url) {
        const img = document.getElementById('edit-image-preview');
        const placeholder = document.getElementById('edit-image-placeholder');
        
        if (url && url.length > 10) {
            img.src = url;
            img.onload = () => {
                img.classList.remove('hidden');
                placeholder.classList.add('hidden');
            };
            img.onerror = () => {
                img.classList.add('hidden');
                placeholder.classList.remove('hidden');
            };
        } else {
            img.classList.add('hidden');
            placeholder.classList.remove('hidden');
        }
    }

    function closeEditModal() {
        document.getElementById('edit-modal').classList.add('hidden');
    }

    async function savePortfolioItem() {
        const id = document.getElementById('edit-id').value;
        const btn = document.getElementById('save-btn');
        const originalText = btn.textContent;
        
        const data = {
            title: document.getElementById('edit-title').value,
            category: document.getElementById('edit-category').value,
            description: document.getElementById('edit-description').value,
            imageSrc: document.getElementById('edit-image').value,
            linkUrl: document.getElementById('edit-link').value,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        if (!data.title) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠'); return; }

        btn.disabled = true;
        btn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

        try {
            if (id) {
                await db.collection(COLLECTION_NAME).doc(id).update(data);
            } else {
                data.createdAt = firebase.firestore.FieldValue.serverTimestamp();
                // Assign new items to the end of the list
                data.order = Date.now(); 
                await db.collection(COLLECTION_NAME).add(data);
            }
            closeEditModal();
            fetchPortfolio(); 
        } catch (error) {
            console.error("Error saving:", error);
            alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + error.message);
        } finally {
            btn.disabled = false;
            btn.textContent = originalText;
        }
    }

    // DELETE
    async function deleteItem(id, event) {
        event.stopPropagation();
        if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) return;

        try {
            await db.collection(COLLECTION_NAME).doc(id).delete();
            fetchPortfolio();
        } catch (error) {
            alert('‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + error.message);
        }
    }

    // =============================================================
    // 5. General UI Logic
    // =============================================================

    let currentFilter = "TEA2201";
    let currentSlideIndex = 0;
    let sliderAutoplayInterval = null;
    let config = { ...defaultConfig };

    function initSlider() {
      if(portfolioData.length === 0) return;
      generateSliderItems();
      generateSliderDots();
      updateSliderDisplay();
      startSliderAutoplay();
      attachSliderEvents();
    }

    function generateSliderItems() {
      const track = document.getElementById('slider-track');
      const items = portfolioData.slice(0, 15); 
      track.innerHTML = items.map((item, index) => `
        <div class="slider-item relative">
          ${item.imageSrc ? `
            <img src="${item.imageSrc}" class="w-full h-full object-cover" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            <div class="absolute inset-0 hidden items-center justify-center bg-slate-700">
               <svg class="w-16 h-16 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
            </div>
          ` : `
            <div class="w-full h-full bg-slate-700 flex items-center justify-center">
              <svg class="w-16 h-16 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
            </div>
          `}
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
        </div>
      `).join('');
    }

    function generateSliderDots() {
      const dotsContainer = document.getElementById('slider-dots');
      const items = portfolioData.slice(0, 15);
      dotsContainer.innerHTML = items.map((_, index) => `
        <button class="slider-dot h-2 rounded-full bg-white/40 hover:bg-white/60 ${index === 0 ? 'active' : ''}" onclick="goToSlide(${index})"></button>
      `).join('');
    }

    function updateSliderDisplay() {
      const items = portfolioData.slice(0, 15);
      if(items.length === 0) return;
      
      const track = document.getElementById('slider-track');
      track.style.transform = `translateX(-${currentSlideIndex * 100}%)`;
      
      document.querySelectorAll('.slider-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlideIndex);
      });
      
      const item = items[currentSlideIndex];
      if (item) {
        document.getElementById('featured-category').textContent = item.category;
        document.getElementById('featured-title').textContent = item.title;
        document.getElementById('featured-description').textContent = item.description;
        
        const actionsContainer = document.getElementById('featured-actions');
        const itemIdParam = typeof item.id === 'string' ? `'${item.id}'` : item.id;
        
        let html = `
             <button onclick="openLightbox(${itemIdParam})" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-white text-sm font-medium transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
              ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
            </button>`;
            
        if (item.linkUrl) {
           html = `<a href="${item.linkUrl}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white text-sm font-medium hover:opacity-90 transition-opacity">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
              ‡∏î‡∏π‡∏ú‡∏•‡∏á‡∏≤‡∏ô
            </a>` + html;
        }
        actionsContainer.innerHTML = html;
      }
    }

    function goToSlide(index) {
      currentSlideIndex = index;
      resetSliderAutoplay();
      updateSliderDisplay();
    }

    function nextSlide() {
      const items = portfolioData.slice(0, 15);
      currentSlideIndex = (currentSlideIndex + 1) % items.length;
      resetSliderAutoplay();
      updateSliderDisplay();
    }

    function prevSlide() {
      const items = portfolioData.slice(0, 15);
      currentSlideIndex = (currentSlideIndex - 1 + items.length) % items.length;
      resetSliderAutoplay();
      updateSliderDisplay();
    }

    function startSliderAutoplay() {
      sliderAutoplayInterval = setInterval(() => {
        const items = portfolioData.slice(0, 15);
        if(items.length > 0) {
            currentSlideIndex = (currentSlideIndex + 1) % items.length;
            updateSliderDisplay();
        }
      }, 5000);
    }

    function resetSliderAutoplay() {
      clearInterval(sliderAutoplayInterval);
      startSliderAutoplay();
    }

    function attachSliderEvents() {
      const prevBtn = document.getElementById('slider-prev');
      const nextBtn = document.getElementById('slider-next');
      if (prevBtn) { prevBtn.replaceWith(prevBtn.cloneNode(true)); document.getElementById('slider-prev').addEventListener('click', prevSlide); }
      if (nextBtn) { nextBtn.replaceWith(nextBtn.cloneNode(true)); document.getElementById('slider-next').addEventListener('click', nextSlide); }
      
      const slider = document.querySelector('.slider-container');
      if (slider) {
        slider.addEventListener('mouseenter', () => { if (window.innerWidth >= 1024) clearInterval(sliderAutoplayInterval); });
        slider.addEventListener('mouseleave', () => startSliderAutoplay());
      }
    }

    function generateMenu(containerId, isMobile = false) {
      const container = document.getElementById(containerId);
      if (!container) return;
      container.innerHTML = categories.map(cat => `
        <button class="menu-btn w-full text-left px-4 py-3 rounded-lg text-slate-300 hover:text-white flex items-center gap-3 ${currentFilter === cat.id ? 'active' : ''}" data-category="${cat.id}" onclick="filterPortfolio('${cat.id}')">
          <span class="text-lg">${cat.icon}</span>
          <span class="${isMobile ? 'text-sm' : ''}">${cat.name}</span>
          <span class="ml-auto text-xs px-2 py-1 rounded-full bg-slate-700 text-slate-400">${cat.id === 'all' ? portfolioData.length : portfolioData.filter(p => p.category === cat.id).length}</span>
        </button>
      `).join('');
    }

    function generatePortfolioCards() {
      const grid = document.getElementById('portfolio-grid');
      const emptyState = document.getElementById('empty-state');
      const filteredData = currentFilter === 'all' ? portfolioData : portfolioData.filter(item => item.category === currentFilter);
      
      document.getElementById('item-count').textContent = filteredData.length;
      document.getElementById('current-filter').textContent = categories.find(c => c.id === currentFilter)?.name || '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
      
      if (filteredData.length === 0) {
        grid.classList.add('hidden');
        emptyState.classList.remove('hidden');
        return;
      }
      
      grid.classList.remove('hidden');
      emptyState.classList.add('hidden');
      
      grid.innerHTML = filteredData.map((item, index) => {
        const itemIdParam = typeof item.id === 'string' ? `'${item.id}'` : item.id;
        
        return `
        <div class="portfolio-card glass rounded-2xl overflow-hidden cursor-pointer group relative" style="animation-delay: ${index * 0.1}s" onclick="openLightbox(${itemIdParam})">
          <div class="admin-controls absolute top-2 right-2 z-30 gap-2">
               <button onclick="moveItem(${itemIdParam}, -1, event)" class="p-2 bg-blue-600/80 hover:bg-blue-600 text-white rounded-lg shadow-lg backdrop-blur-sm transition-colors" title="‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/></svg>
               </button>
               <button onclick="moveItem(${itemIdParam}, 1, event)" class="p-2 bg-blue-600/80 hover:bg-blue-600 text-white rounded-lg shadow-lg backdrop-blur-sm transition-colors" title="‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
               </button>
               
              <button onclick="openEditModal(${itemIdParam}); event.stopPropagation();" class="p-2 bg-yellow-500/80 hover:bg-yellow-500 text-white rounded-lg shadow-lg backdrop-blur-sm transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg></button>
              <button onclick="deleteItem(${itemIdParam}, event)" class="p-2 bg-red-500/80 hover:bg-red-500 text-white rounded-lg shadow-lg backdrop-blur-sm transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>
          </div>
          
          <div class="aspect-video relative overflow-hidden bg-slate-700">
            ${item.imageSrc ? `
              <img src="${item.imageSrc}" class="card-image w-full h-full object-cover" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
              <div class="absolute inset-0 hidden items-center justify-center bg-slate-700">
                <svg class="w-12 h-12 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
              </div>
            ` : `
              <div class="w-full h-full flex items-center justify-center">
                <svg class="w-12 h-12 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
              </div>
            `}
            <div class="card-overlay absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent flex items-end p-4">
              <span class="px-2 py-1 rounded text-xs font-medium bg-blue-500/80 text-white">${item.category}</span>
            </div>
          </div>
          <div class="p-4">
            <h3 class="font-semibold text-white mb-2 line-clamp-2">${item.title}</h3>
            <p class="text-sm text-slate-400 line-clamp-2">${item.description}</p>
            <div class="mt-3 flex items-center gap-2">
              ${item.linkUrl ? `<span class="text-xs text-green-400 flex items-center gap-1"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg>‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Ñ‡πå</span>` : ''}
            </div>
          </div>
        </div>
      `}).join('');
    }

    function filterPortfolio(category) {
      currentFilter = category;
      generateMenu('menu-container');
      generateMenu('mobile-nav', true);
      generatePortfolioCards();
      closeMobileMenu();
    }

    function openLightbox(id) {
      const item = portfolioData.find(p => p.id === id);
      if (!item) return;
      
      const modal = document.getElementById('lightbox-modal');
      document.getElementById('modal-category').textContent = item.category;
      document.getElementById('modal-title').textContent = item.title;
      document.getElementById('modal-description').textContent = item.description;
      
      const modalImage = document.getElementById('modal-image');
      if (item.imageSrc) {
        modalImage.src = item.imageSrc;
        modalImage.style.display = 'block';
        modalImage.nextElementSibling.style.display = 'none';
      } else {
        modalImage.style.display = 'none';
        modalImage.nextElementSibling.style.display = 'flex';
      }
      
      const linkBtn = document.getElementById('modal-link');
      if (item.linkUrl) {
        linkBtn.href = item.linkUrl;
        linkBtn.classList.remove('hidden');
      } else {
        linkBtn.classList.add('hidden');
      }
      
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      document.getElementById('lightbox-modal').classList.add('hidden');
      document.body.style.overflow = '';
    }

    function openMobileMenu() {
      const overlay = document.getElementById('mobile-menu-overlay');
      const menu = overlay.querySelector('.mobile-menu');
      overlay.classList.remove('hidden');
      setTimeout(() => { menu.classList.remove('hidden'); menu.classList.add('visible'); }, 10);
    }

    function closeMobileMenu() {
      const overlay = document.getElementById('mobile-menu-overlay');
      const menu = overlay.querySelector('.mobile-menu');
      menu.classList.remove('visible');
      menu.classList.add('hidden');
      setTimeout(() => { overlay.classList.add('hidden'); }, 300);
    }

    function updateUI(cfg) {
      ['sidebar-name', 'sidebar-name-mobile', 'mobile-name'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.textContent = id === 'mobile-name' ? cfg.owner_name.split(' ')[0].replace(/‡∏ô‡∏≤‡∏¢|‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß/, '') : cfg.owner_name;
      });
      ['sidebar-major', 'sidebar-major-mobile'].forEach(id => { const el = document.getElementById(id); if (el) el.textContent = cfg.owner_major; });
      ['sidebar-id', 'sidebar-id-mobile'].forEach(id => { const el = document.getElementById(id); if (el) el.textContent = cfg.owner_id; });
      ['contact-email', 'contact-email-mobile'].forEach(id => { const el = document.getElementById(id); if (el) { el.href = `mailto:${cfg.contact_email}`; el.querySelector('span').textContent = cfg.contact_email; } });
      ['contact-phone', 'contact-phone-mobile'].forEach(id => { const el = document.getElementById(id); if (el) { el.href = `tel:${cfg.contact_phone}`; el.querySelector('span').textContent = cfg.contact_phone; } });
    }

    document.getElementById('close-modal').addEventListener('click', closeLightbox);
    document.getElementById('modal-backdrop').addEventListener('click', closeLightbox);
    document.getElementById('mobile-menu-btn').addEventListener('click', openMobileMenu);
    document.getElementById('close-menu-btn').addEventListener('click', closeMobileMenu);
    document.getElementById('overlay-backdrop').addEventListener('click', closeMobileMenu);
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') { closeLightbox(); closeMobileMenu(); closeEditModal(); toggleLoginModal(); }
    });

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => { config = { ...newConfig }; updateUI(config); },
        mapToCapabilities: (cfg) => ({ recolorables: [], borderables: [], fontEditable: undefined, fontSizeable: undefined }),
        mapToEditPanelValues: (cfg) => new Map([["owner_name", cfg.owner_name], ["owner_major", cfg.owner_major], ["owner_id", cfg.owner_id], ["contact_email", cfg.contact_email], ["contact_phone", cfg.contact_phone]])
      });
    }

    function init() {
      fetchPortfolio();
      updateUI(config);
      // Ensure strict startup state
      isAdmin = false;
      document.body.classList.remove('is-admin');
    }

    init();
  </script>
 </body>
</html>